import { MINUTE, SECOND } from '../utils/const/index';

export enum Perspective {
  Administrator = 'Administrator',
  Developer = 'Developer',
  Virtualization = 'Virtualization',
}

export const tour = '[data-test="tour-step-footer-secondary"]';
export const topology = '[data-test-id="topology-header"]';

const header = '[data-quickstart-id="qs-perspective-switcher"]';
const option = 'button.pf-v5-c-menu__item';
const toggle = '[data-test-id="perspective-switcher-toggle"]';
const menu = '[data-test-id="perspective-switcher-menu"]';

export const switchPerspective = (perspective: Perspective) => {
  // save redundant switching
  cy.get(header, { timeout: 5 * MINUTE }).should('be.visible');
  cy.wait(5 * SECOND);
  cy.get(header).within(($title) => {
    if ($title.find('h2').text() == perspective) {
      cy.task('log', `Already at [${perspective}]`);
      return;
    }
    cy.get(toggle).click();
    cy.get(menu).should('be.visible');
    cy.contains(option, perspective).click();
    cy.task('log', `Switching to [${perspective}]`);
  });
};
